<<<<<<<< HEAD:docs/assets/image-CJfIO0ON.js
import{o as P,q as N}from"./index-Iikal-yj.js";let S=null;async function p(){if(S)return S;const t="./".replace(/\/+$/,"/"),n=[{family:"NotoSans",weight:"400",style:"normal",file:"NotoSans-Regular.ttf"},{family:"NotoSans",weight:"700",style:"normal",file:"NotoSans-Bold.ttf"},{family:"NotoSans",weight:"400",style:"italic",file:"NotoSans-Italic.ttf"},{family:"NotoSans",weight:"700",style:"italic",file:"NotoSans-BoldItalic.ttf"},{family:"NotoSansMono",weight:"400",style:"normal",file:"NotoSansMono-Regular.ttf"},{family:"NotoSansMono",weight:"700",style:"normal",file:"NotoSansMono-Bold.ttf"}];return S=Promise.all(n.map(async i=>{const a=await new FontFace(i.family,`url(${t}fonts/${i.file})`,{weight:i.weight,style:i.style}).load();document.fonts.add(a)})).then(()=>({lyricFamily:"NotoSans",chordFamily:"NotoSansMono"})).catch(()=>({lyricFamily:"Helvetica",chordFamily:"Courier"})),S}function T(t,{pxWidth:n,pxHeight:i,dpi:m=150}){const a=document.createElement("canvas");a.width=n,a.height=i;const e=a.getContext("2d");e.fillStyle="#fff",e.fillRect(0,0,a.width,a.height);const u=m/72;e.scale(u,u);const c=t.margin,h=Math.max(22,t.lyricSizePt+6),d=Math.max(12,t.lyricSizePt-2);e.fillStyle="#000",e.font=`bold ${h}px ${t.lyricFamily}`,e.fillText(String(t.title||"Untitled"),c,c+24),e.font=`italic ${d}px ${t.lyricFamily}`;const l=String(t.key||"—");e.fillText(`Key of ${l}`,c,c+40);const g=4,r=t.lyricSizePt,x=Math.round(t.lyricSizePt*.85),f=c+(t.headerOffsetY||h*1.05+d*1.05+12);return(t.layout.pages||[])[0].columns.forEach($=>{let s=$.x,o=f;$.blocks.forEach(y=>{y.type==="section"?(o+=x,e.font=`bold ${r}px ${t.lyricFamily}`,e.fillText(`[${y.header}]`,s,o),o+=r+4):y.type==="line"&&(y.chords?.length&&(e.font=`bold ${t.chordSizePt}px ${t.chordFamily}`,y.chords.forEach(w=>e.fillText(w.sym,s+w.x,o)),o+=t.chordSizePt+g/2),e.font=`normal ${t.lyricSizePt}px ${t.lyricFamily}`,e.fillText(y.lyrics,s,o),o+=t.lyricSizePt+g)})}),a}async function z(t,n={}){const i=n.dpi||150,m=n.widthInches||8.5,a=n.heightInches||11,e=Math.round(m*i),u=Math.round(a*i),c=await p(),{lyricFamily:h,chordFamily:d}=c;let l=n.plan;if(!l){const f=document.createElement("canvas").getContext("2d");l=P(t,{lyricFamily:h,chordFamily:d},s=>o=>(f.font=`${s}px ${h}`,f.measureText(o||"").width),s=>o=>(f.font=`bold ${s}px ${d}`,f.measureText(o||"").width)).plan}if(l.layout.pages.length>1)return{error:"MULTI_PAGE",plan:l};const g=T(l,{pxWidth:e,pxHeight:u,dpi:i}),r=document.createElement("a"),x=N(String(n.slug||t.slug||t.title||"untitled"));return r.href=g.toDataURL("image/jpeg",.92),r.download=`${x}.jpg`,r.click(),{plan:l}}export{z as downloadSingleSongJpg,p as ensureCanvasFonts,T as renderPlanToCanvas};
========
import{o as P,q as N}from"./index-C4a5WNds.js";let S=null;async function p(){if(S)return S;const t="./".replace(/\/+$/,"/"),n=[{family:"NotoSans",weight:"400",style:"normal",file:"NotoSans-Regular.ttf"},{family:"NotoSans",weight:"700",style:"normal",file:"NotoSans-Bold.ttf"},{family:"NotoSans",weight:"400",style:"italic",file:"NotoSans-Italic.ttf"},{family:"NotoSans",weight:"700",style:"italic",file:"NotoSans-BoldItalic.ttf"},{family:"NotoSansMono",weight:"400",style:"normal",file:"NotoSansMono-Regular.ttf"},{family:"NotoSansMono",weight:"700",style:"normal",file:"NotoSansMono-Bold.ttf"}];return S=Promise.all(n.map(async i=>{const a=await new FontFace(i.family,`url(${t}fonts/${i.file})`,{weight:i.weight,style:i.style}).load();document.fonts.add(a)})).then(()=>({lyricFamily:"NotoSans",chordFamily:"NotoSansMono"})).catch(()=>({lyricFamily:"Helvetica",chordFamily:"Courier"})),S}function T(t,{pxWidth:n,pxHeight:i,dpi:m=150}){const a=document.createElement("canvas");a.width=n,a.height=i;const e=a.getContext("2d");e.fillStyle="#fff",e.fillRect(0,0,a.width,a.height);const u=m/72;e.scale(u,u);const c=t.margin,h=Math.max(22,t.lyricSizePt+6),d=Math.max(12,t.lyricSizePt-2);e.fillStyle="#000",e.font=`bold ${h}px ${t.lyricFamily}`,e.fillText(String(t.title||"Untitled"),c,c+24),e.font=`italic ${d}px ${t.lyricFamily}`;const l=String(t.key||"—");e.fillText(`Key of ${l}`,c,c+40);const g=4,r=t.lyricSizePt,x=Math.round(t.lyricSizePt*.85),f=c+(t.headerOffsetY||h*1.05+d*1.05+12);return(t.layout.pages||[])[0].columns.forEach($=>{let s=$.x,o=f;$.blocks.forEach(y=>{y.type==="section"?(o+=x,e.font=`bold ${r}px ${t.lyricFamily}`,e.fillText(`[${y.header}]`,s,o),o+=r+4):y.type==="line"&&(y.chords?.length&&(e.font=`bold ${t.chordSizePt}px ${t.chordFamily}`,y.chords.forEach(w=>e.fillText(w.sym,s+w.x,o)),o+=t.chordSizePt+g/2),e.font=`normal ${t.lyricSizePt}px ${t.lyricFamily}`,e.fillText(y.lyrics,s,o),o+=t.lyricSizePt+g)})}),a}async function z(t,n={}){const i=n.dpi||150,m=n.widthInches||8.5,a=n.heightInches||11,e=Math.round(m*i),u=Math.round(a*i),c=await p(),{lyricFamily:h,chordFamily:d}=c;let l=n.plan;if(!l){const f=document.createElement("canvas").getContext("2d");l=P(t,{lyricFamily:h,chordFamily:d},s=>o=>(f.font=`${s}px ${h}`,f.measureText(o||"").width),s=>o=>(f.font=`bold ${s}px ${d}`,f.measureText(o||"").width)).plan}if(l.layout.pages.length>1)return{error:"MULTI_PAGE",plan:l};const g=T(l,{pxWidth:e,pxHeight:u,dpi:i}),r=document.createElement("a"),x=N(String(n.slug||t.slug||t.title||"untitled"));return r.href=g.toDataURL("image/jpeg",.92),r.download=`${x}.jpg`,r.click(),{plan:l}}export{z as downloadSingleSongJpg,p as ensureCanvasFonts,T as renderPlanToCanvas};
>>>>>>>> 8054e054 (trying to fix the color):docs/assets/image-C8i51Yg8.js
