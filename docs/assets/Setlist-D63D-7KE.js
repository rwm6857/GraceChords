const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-B0I7h7eF.js","assets/index-C5eKMLRe.js","assets/index-BLBeZ3GQ.css","assets/index-Dd-5d8az.js"])))=>i.map(i=>d[i]);
import{_ as Oe,p as be,Y as $t,Z as kt,$ as Dt,r as x,i as Bt,a0 as _t,a1 as Ot,F as Kt,a2 as Ut,j as n,a3 as j,a4 as Ze,a5 as Xt,a6 as Ft,a7 as Ge,a8 as fe,a9 as Qe,L as et,aa as tt,ab as Wt,ac as Vt,y as De,D as zt,ad as Be,ae as nt,af as st,ag as rt,ah as it,ai as at,aj as Yt,ak as qt,al as Ht,am as Pe,an as pe,ao as ot,l as Jt,m as Zt,ap as Gt,aq as Qt,ar as en,as as tn,s as ne}from"./index-C5eKMLRe.js";import{P as nn}from"./PageContainer-B1pjbiqh.js";const ht="gracechords.sets.v1";function Me(){try{const e=localStorage.getItem(ht);return e?JSON.parse(e):{sets:{}}}catch{return{sets:{}}}}function gt(e){localStorage.setItem(ht,JSON.stringify(e))}function sn(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"id-"+Math.random().toString(36).slice(2)+Date.now().toString(36)}function we(){const{sets:e}=Me();return Object.values(e).sort((s,r)=>(r.updatedAt||0)-(s.updatedAt||0))}function rn(e){const{sets:s}=Me();return s[e]||null}function lt(e){const s=Date.now(),r={id:e.id||sn(),name:e.name?.trim()||"Untitled Set",items:Array.isArray(e.items)?e.items:[],createdAt:e.createdAt||s,updatedAt:s},d=Me();return d.sets[r.id]=r,gt(d),r}function an(e){const s=Me();return s.sets[e]?(delete s.sets[e],gt(s),!0):!1}const on="application/vnd.openxmlformats-officedocument.presentationml.slide+xml",ct="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml",ln="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml",cn="application/vnd.openxmlformats-officedocument.theme+xml",J="http://schemas.openxmlformats.org/presentationml/2006/main",Ke="http://schemas.openxmlformats.org/officeDocument/2006/relationships",dt="application/vnd.openxmlformats-officedocument.presentationml.notesMaster+xml",dn=new DOMParser,un=new XMLSerializer;function fn(e){const s="setlist",r=String(e).trim();return r&&r.replace(/\s+/g,"_").replace(/[^A-Za-z0-9_.-]/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"")||s}async function ut(e){const s=await fetch(e);if(!s.ok)throw new Error(`Failed to load PPTX: ${e}`);return s.arrayBuffer()}function re(e){const s=dn.parseFromString(e,"application/xml"),r=s.getElementsByTagName("parsererror")[0];if(r)throw new Error(r.textContent||"Failed to parse XML");return s}function Te(e){return un.serializeToString(e)}function W(e){const s=String(e||"").match(/(\d+)$/);return s?Number(s[1]):0}function de(e,s){let r=0;return e.filter(d=>s.test(d)).forEach(d=>{const a=d.name.match(s);if(!a)return;const u=Number(a[1]);Number.isNaN(u)||(r=Math.max(r,u))}),r}function yt(e,s,r){if(Array.from(e.getElementsByTagName("Override")).some(u=>u.getAttribute("PartName")===s))return;const a=e.createElement("Override");a.setAttribute("PartName",s),a.setAttribute("ContentType",r),e.documentElement.appendChild(a)}function me(e,s){if(!s)return null;if(s.startsWith("/"))return s.slice(1);const r=e.split("/");r.pop();const d=s.split("/");for(const a of d)if(a==="..")r.pop();else{if(a===".")continue;r.push(a)}return r.join("/")}function ie(e,s){const r=e.split("/");r.pop();const d=s.split("/");let a=0;for(;a<r.length&&a<d.length&&r[a]===d[a];)a++;const u=r.length-a,m=[];for(let g=0;g<u;g++)m.push("..");return m.push(...d.slice(a)),m.join("/")}function xt(e){const s=e.match(/^(.*\/)([^/]*?)(\d+)(\.[^.]+)$/);return s?{dir:s[1],prefix:s[2],number:Number(s[3]),ext:s[4]}:null}function se(e,s,r){const d=Number(e[s]||0);r>d&&(e[s]=r)}function wt(e,s){const d=Number(e[s]||0)+1;return e[s]=d,d}function V(e,s){if(!e)return null;const r=e.file(s);return Array.isArray(r)?r.length?r[0]:null:r||null}function he(e){const s=e.lastIndexOf("/"),r=s>=0?e.slice(0,s+1):"",d=s>=0?e.slice(s+1):e;return`${r}_rels/${d}.rels`}function pn(e,s){if(!e||!s)return{contentType:"",fromOverride:!1,extension:""};const r=`/${s}`,a=Array.from(e.getElementsByTagName("Override")).find(h=>h.getAttribute("PartName")===r);if(a)return{contentType:a.getAttribute("ContentType")||"",fromOverride:!0,extension:s.split(".").pop()||""};const u=Array.from(e.getElementsByTagName("Default")),m=s.split(".").pop()||"",g=u.find(h=>h.getAttribute("Extension")===m);return g?{contentType:g.getAttribute("ContentType")||"",fromOverride:!1,extension:m}:{contentType:"",fromOverride:!1,extension:m}}function mn(e,s,r){if(!r||Array.from(e.getElementsByTagName("Default")).some(m=>m.getAttribute("Extension")===r))return;const a=Array.from(s?.getElementsByTagName?.("Default")||[]).find(m=>m.getAttribute("Extension")===r);if(!a)return;const u=e.createElement("Default");u.setAttribute("Extension",r),u.setAttribute("ContentType",a.getAttribute("ContentType")||""),e.documentElement.appendChild(u)}function hn(e){return e?!/xml|text|application\/(.*\+xml)/i.test(e):!1}function gn(e){const s=/(.*\D)(\d+)(\.\w+)$/,r=e&&e.match(s);if(r){const[,d,,a]=r;return u=>`${d}${u}${a}`}return d=>`slides/slide${d}.xml`}async function yn(e){const s="ppt/presentation.xml",r=V(e,s);if(!r)throw new Error("Base PPTX missing ppt/presentation.xml");const d=await r.async("string"),a=re(d),u=a.getElementsByTagNameNS(J,"sldIdLst")[0]||a.getElementsByTagName("p:sldIdLst")[0],g=(u?Array.from(u.getElementsByTagNameNS(J,"sldId")).concat(Array.from(u.getElementsByTagName("p:sldId"))):[]).reduce((y,b)=>{const P=Number(b.getAttribute("id"));return Number.isNaN(P)?y:Math.max(y,P)},255),h="ppt/_rels/presentation.xml.rels",N=V(e,h);if(!N)throw new Error("Base PPTX missing ppt/_rels/presentation.xml.rels");const S=await N.async("string"),$=re(S),p=Array.from($.getElementsByTagName("Relationship")),R=p.reduce((y,b)=>{const P=W(b.getAttribute("Id"));return Math.max(y,P)},0),K=p.filter(y=>(y.getAttribute("Type")||"").endsWith("/slide")),I=K.length&&K[0].getAttribute("Target")||"",C=gn(I),k=a.getElementsByTagNameNS(J,"sldMasterIdLst")[0]||a.getElementsByTagName("p:sldMasterIdLst")[0]||null,D=(k?Array.from(k.getElementsByTagNameNS(J,"sldMasterId")).concat(Array.from(k.getElementsByTagName("p:sldMasterId"))):[]).reduce((y,b)=>{const P=Number(b.getAttribute("id"));return Number.isNaN(P)?y:Math.max(y,P)},2147483647),Z=a.getElementsByTagNameNS(J,"notesMasterIdLst")[0]||a.getElementsByTagName("p:notesMasterIdLst")[0]||null;let z=null;const ae=p.find(y=>(y.getAttribute("Type")||"").endsWith("/notesMaster"));if(ae){const y=ae.getAttribute("Target")||"";z=me("ppt/presentation.xml",y)}let oe=null;const ge=p.find(y=>(y.getAttribute("Type")||"").endsWith("/theme"));if(ge){const y=ge.getAttribute("Target")||"";oe=me("ppt/presentation.xml",y)}const ee="[Content_Types].xml",le=V(e,ee);if(!le)throw new Error("Base PPTX missing [Content_Types].xml");const Ce=await le.async("string"),je=re(Ce),U={};e.filter(()=>!0).forEach(y=>{const b=xt(y.name);if(!b)return;const P=`${b.dir}${b.prefix}`;se(U,P,b.number)}),se(U,"ppt/slides/slide",de(e,/^ppt\/slides\/slide(\d+)\.xml$/)),se(U,"ppt/notesSlides/notesSlide",de(e,/^ppt\/notesSlides\/notesSlide(\d+)\.xml$/)),se(U,"ppt/slideMasters/slideMaster",de(e,/^ppt\/slideMasters\/slideMaster(\d+)\.xml$/)),se(U,"ppt/slideLayouts/slideLayout",de(e,/^ppt\/slideLayouts\/slideLayout(\d+)\.xml$/)),se(U,"ppt/theme/theme",de(e,/^ppt\/theme\/theme(\d+)\.xml$/)),se(U,"ppt/notesMasters/notesMaster",de(e,/^ppt\/notesMasters\/notesMaster(\d+)\.xml$/)),se(U,"ppt/media/image",de(e,/^ppt\/media\/image(\d+)\.[^.]+$/));const te=e.file(/^ppt\/slides\/slide\d+\.xml$/).sort((y,b)=>W(y.name)-W(b.name));let Y="",B="",G="";if(te.length){const y=te[0],b=V(e,he(y.name));if(b){const P=re(await b.async("string")),q=Array.from(P.getElementsByTagName("Relationship")).find(O=>(O.getAttribute("Type")||"").endsWith("/slideLayout"));if(q){Y=q.getAttribute("Target")||"";const O=me(y.name,Y);O&&V(e,O)&&(B=O)}}}if(B)!Y&&te.length&&(Y=ie(te[0].name,B));else{const y=e.file(/^ppt\/slideLayouts\/.*\.xml$/).sort((b,P)=>W(b.name)-W(P.name));y.length&&(B=y[0].name,Y=te.length?ie(te[0].name,B):"../slideLayouts/slideLayout1.xml")}if(B){const y=V(e,he(B));if(y){const b=re(await y.async("string")),ye=Array.from(b.getElementsByTagName("Relationship")).find(q=>(q.getAttribute("Type")||"").endsWith("/slideMaster"));if(ye){const q=ye.getAttribute("Target")||"",O=me(B,q);O&&V(e,O)&&(G=O)}}}if(!G){const y=e.file(/^ppt\/slideMasters\/.*\.xml$/).sort((b,P)=>W(b.name)-W(P.name));y.length&&(G=y[0].name)}if(!z){const y=e.file(/^ppt\/notesMasters\/.*\.xml$/).sort((b,P)=>W(b.name)-W(P.name));y.length&&(z=y[0].name)}return{zip:e,presentationXmlPath:s,presentationDoc:a,sldIdList:u,sldMasterList:k,notesMasterList:Z,presentationRelsPath:h,presentationRelsDoc:$,contentTypesPath:ee,contentTypesDoc:je,nextSlideId:g,nextRelId:R,nextMasterId:D,counters:U,partMap:new Map,masterRelMap:new Map,notesMasterRelMap:new Map,getSlideTarget:C,defaultLayoutTarget:Y,defaultLayoutPath:B,defaultMasterPath:G,defaultNotesMasterPath:z,defaultThemePath:oe}}function xn(e,s,r){const d=e.presentationRelsDoc.documentElement,a=e.presentationRelsDoc.createElement("Relationship");a.setAttribute("Id",r),a.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide");const u=e.getSlideTarget?e.getSlideTarget(s):`slides/slide${s}.xml`;a.setAttribute("Target",u),d.appendChild(a)}function wn(e,s){const r=e.presentationDoc,d=e.sldIdList||(()=>{const u=r.createElementNS(J,"p:sldIdLst");return r.documentElement.appendChild(u),e.sldIdList=u,u})(),a=r.createElementNS(J,"p:sldId");e.nextSlideId+=1,a.setAttribute("id",String(e.nextSlideId)),a.setAttributeNS(Ke,"r:id",s),d.appendChild(a)}function Sn(e,s){if(e.masterRelMap.has(s))return e.masterRelMap.get(s);const r=e.presentationDoc,d=e.presentationRelsDoc;let a=e.sldMasterList;if(!a){a=r.createElementNS(J,"p:sldMasterIdLst");const h=r.documentElement.firstChild;h?r.documentElement.insertBefore(a,h):r.documentElement.appendChild(a),e.sldMasterList=a}e.nextMasterId=Number(e.nextMasterId||2147483647),e.nextMasterId+=1,e.nextRelId+=1;const u=`rId${e.nextRelId}`,m=r.createElementNS(J,"p:sldMasterId");m.setAttribute("id",String(e.nextMasterId)),m.setAttributeNS(Ke,"r:id",u),a.appendChild(m);const g=d.createElement("Relationship");return g.setAttribute("Id",u),g.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),g.setAttribute("Target",ie("ppt/presentation.xml",s)),d.documentElement.appendChild(g),e.masterRelMap.set(s,u),u}function bn(e,s){if(e.notesMasterRelMap.has(s))return e.notesMasterRelMap.get(s);const r=e.presentationDoc,d=e.presentationRelsDoc;let a=e.notesMasterList;if(!a){a=r.createElementNS(J,"p:notesMasterIdLst");const h=r.documentElement,N=e.sldIdList||h.firstChild;N?h.insertBefore(a,N):h.appendChild(a),e.notesMasterList=a}e.nextRelId+=1;const u=`rId${e.nextRelId}`,m=r.createElementNS(J,"p:notesMasterId");m.setAttributeNS(Ke,"r:id",u),a.appendChild(m);const g=d.createElement("Relationship");return g.setAttribute("Id",u),g.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster"),g.setAttribute("Target",ie("ppt/presentation.xml",s)),d.documentElement.appendChild(g),e.notesMasterRelMap.set(s,u),u}async function Ee(e,s,r,d,a,u={}){if(!a)return null;const m=`${d}:${a}`;if(e.partMap.has(m))return e.partMap.get(m);const g=pn(r,a),h=V(s,a);if(!h)return null;if(g.contentType===ln&&e.defaultLayoutPath)return e.partMap.set(m,e.defaultLayoutPath),e.defaultLayoutPath;if(g.contentType===ct&&e.defaultMasterPath)return e.partMap.set(m,e.defaultMasterPath),e.defaultMasterPath;if(g.contentType===dt&&e.defaultNotesMasterPath)return e.partMap.set(m,e.defaultNotesMasterPath),e.defaultNotesMasterPath;if(g.contentType===cn&&e.defaultThemePath)return e.partMap.set(m,e.defaultThemePath),e.defaultThemePath;const N=xt(a);let S;if(N){const K=`${N.dir}${N.prefix}`,I=wt(e.counters,K);S=`${N.dir}${N.prefix}${I}${N.ext}`}else{if(V(e.zip,a))return e.partMap.set(m,a),a;S=a}e.partMap.set(m,S),g.fromOverride?yt(e.contentTypesDoc,`/${S}`,g.contentType):g.extension&&mn(e.contentTypesDoc,r,g.extension);const $=await h.async(hn(g.contentType)?"uint8array":"string");e.zip.file(S,$);const p=he(a),R=V(s,p);if(R){const K=await R.async("string"),I=re(K),C=Array.from(I.getElementsByTagName("Relationship"));for(const A of C){if((A.getAttribute("TargetMode")||"").toLowerCase()==="external")continue;const Z=A.getAttribute("Target")||"",z=me(a,Z);if(!z)continue;let ae=null;if(typeof u.relationshipMutator=="function"){const ee=await u.relationshipMutator({node:A,type:A.getAttribute("Type")||"",absolutePath:z,newPartPath:S,originalPartPath:a});if(ee===!1)continue;ee&&ee.targetPath&&(ae=ee.targetPath)}const oe=ae||await Ee(e,s,r,d,z);if(!oe)continue;const ge=ie(S,oe);A.setAttribute("Target",ge)}const k=he(S);e.zip.file(k,Te(I))}return g.contentType===ct?Sn(e,S):g.contentType===dt&&bn(e,S),S}async function Tn(e,s,r,d,a,u){const m=he(a),g=V(s,m);if(!g)return;const h=await g.async("string"),N=re(h),S=Array.from(N.getElementsByTagName("Relationship")),$=N.documentElement;let p=!1,R=S.reduce((I,C)=>{const k=C.getAttribute("Id")||"";return Math.max(I,W(k))},0);for(const I of S){const C=I.getAttribute("Type")||"",k=I.getAttribute("Target")||"";if(!k)continue;const A=me(a,k);if(A){if(C.endsWith("/slideLayout")){e.defaultLayoutTarget?p?$.removeChild(I):(p=!0,I.setAttribute("Target",e.defaultLayoutTarget)):p?$.removeChild(I):p=!0;continue}if(C.endsWith("/notesSlide")){const D=await Ee(e,s,r,d,A,{relationshipMutator:({type:Z})=>Z.endsWith("/slide")?{targetPath:u}:null});if(!D)continue;I.setAttribute("Target",ie(u,D))}else if(C.includes("/image")||C.includes("/audio")||C.includes("/video")){const D=await Ee(e,s,r,d,A);if(!D)continue;I.setAttribute("Target",ie(u,D))}else{const D=await Ee(e,s,r,d,A);if(!D)continue;I.setAttribute("Target",ie(u,D))}}}if(!p&&e.defaultLayoutTarget){const I=N.createElement("Relationship"),C=`rId${R+1||1}`;I.setAttribute("Id",C),I.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),I.setAttribute("Target",e.defaultLayoutTarget),$.appendChild(I)}const K=he(u);e.zip.file(K,Te(N))}async function jn(e,s,r){const d=s.file(/^ppt\/slides\/slide\d+\.xml$/).sort((m,g)=>{const h=W(m.name),N=W(g.name);return h-N});if(!d.length)return;const a=V(s,"[Content_Types].xml");if(!a)throw new Error("Source PPTX missing [Content_Types].xml");const u=re(await a.async("string"));for(const m of d){const g=wt(e.counters,"ppt/slides/slide"),h=`ppt/slides/slide${g}.xml`,N=await m.async("string");e.zip.file(h,N),yt(e.contentTypesDoc,`/${h}`,on),e.nextRelId+=1;const S=`rId${e.nextRelId}`;xn(e,g,S),wn(e,S);const $=m.name;e.partMap.set(`${r}:${$}`,h),await Tn(e,s,u,r,$,h)}}function vn(e){e.zip.file(e.presentationXmlPath,Te(e.presentationDoc)),e.zip.file(e.presentationRelsPath,Te(e.presentationRelsDoc)),e.zip.file(e.contentTypesPath,Te(e.contentTypesDoc))}function Nn(e,s){const r=document.createElement("a");r.href=URL.createObjectURL(e),r.download=s,r.rel="noopener",r.click(),URL.revokeObjectURL(r.href)}async function In(e=[],s="Setlist"){if(!Array.isArray(e)||e.length===0)throw new Error("No PPTX files to merge");const r=(await Oe(async()=>{const{default:S}=await import("./jszip.min-B0I7h7eF.js").then($=>$.j);return{default:S}},__vite__mapDeps([0,1,2]))).default,[d,...a]=e,u=await ut(d),m=await r.loadAsync(u),g=await yn(m);for(let S=0;S<a.length;S++){const $=await ut(a[S]),p=await r.loadAsync($);await jn(g,p,`src${S+1}`)}vn(g);const h=await m.generateAsync({type:"blob"}),N=fn(s||"Setlist");Nn(h,`${N}.pptx`)}function Pn(e){return e?e.slug?e.slug:e.filename?e.filename.replace(/\.chordpro$/i,""):e.title?e.title.trim().toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_.-]/g,""):"":""}async function En(e={},s={}){const{name:r="Setlist",songs:d=[]}=e||{},{availablePptxMap:a=null,onEmpty:u}=s,m=[];for(const g of d){const h=Pn(g);h&&(a&&!a[h]||m.push(be(`pptx/${h}.pptx`)))}if(!m.length){typeof u=="function"&&u();return}await In(m,r)}let ft;const pt=()=>ft||(ft=Oe(()=>import("./index-Dd-5d8az.js").then(e=>e.i),__vite__mapDeps([3,1,2])));function Mn(){try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`sel-${Math.random().toString(36).slice(2)}${Date.now().toString(36)}`}function _e(e){if(!e)return null;const{id:s,toKey:r=""}=e;return s==null?null:{uid:Mn(),id:s,toKey:r}}function Se(e=[]){return e.map(s=>_e(s)).filter(Boolean)}function mt(e){try{return decodeURIComponent(e)}catch{return e}}function Ln(){const{code:e,songIds:s}=$t(),r=kt(),d=Dt(),[a,u]=x.useState("New Setlist"),[m,g]=x.useState(""),[h,N]=x.useState([]),[S,$]=x.useState(()=>{try{return localStorage.getItem("pref:icpOnly")==="1"}catch{return!1}});x.useEffect(()=>{try{localStorage.setItem("pref:icpOnly",S?"1":"0")}catch{}},[S]);const[p,R]=x.useState([]),[K,I]=x.useState({}),[C,k]=x.useState(""),[A,D]=x.useState("");Object.keys(K).length;const[Z,z]=x.useState(!1),[ae,oe]=x.useState(()=>{try{return window.innerWidth<=640}catch{return!1}}),[ge,ee]=x.useState(()=>{try{return window.innerWidth<=820}catch{return!1}}),[le,Ce]=x.useState(()=>{try{return window.innerWidth<=900}catch{return!1}}),je=x.useRef(""),U=x.useRef(""),te=x.useRef(!1),[Y,B]=x.useState(null),[G,y]=x.useState(()=>we()),[b,P]=x.useState(""),[ye,q]=x.useState(!1),[O,Ae]=x.useState(""),[Le,Re]=x.useState(!1),[ce,ve]=x.useState(""),[$e,ue]=x.useState(""),[xe,St]=x.useState(""),bt=x.useRef(new Map);x.useEffect(()=>{const t=Bt?.items||[],i=new Set,c=[];for(const o of t)i.has(o.id)||_t(o)||(i.add(o.id),c.push(o));N(c)},[]),x.useEffect(()=>{let t=!1;async function i(){const c={};for(const o of p){const l=h.find(_=>_.id===o.id);if(!l)continue;const f=l.filename.replace(/\.chordpro$/i,""),w=be(`pptx/${f}.pptx`);await qt(w,f)&&(c[f]=!0)}t||I(c)}return i(),()=>{t=!0}},[p,h]),x.useEffect(()=>{try{const t=document.documentElement,i=document.body;je.current=t.style.overflowY||"",U.current=i.style.overflowY||"",getComputedStyle(t).overflowY==="hidden"&&(t.style.overflowY=""),getComputedStyle(i).overflowY==="hidden"&&(i.style.overflowY="")}catch{}return()=>{try{document.documentElement.style.overflowY=je.current,document.body.style.overflowY=U.current}catch{}}},[]),x.useEffect(()=>{if(!e)return;const{entries:t,error:i}=Ot(e);if(i){alert(i),d("/setlist",{replace:!0});return}const c=t.map(f=>({id:f.id,toKey:f.toKey}));R(Se(c));const o=c.map(f=>encodeURIComponent(f.id)).join(","),l=c.map(f=>encodeURIComponent(f.toKey||"")).join(",");d(`/setlist/${o}?toKeys=${l}`,{replace:!0})},[e]),x.useEffect(()=>{if(!s)return;const t=(s||"").split(",").map(l=>mt(l.trim())).filter(Boolean);if(!t.length)return;const c=(new URLSearchParams(r.search||"").get("toKeys")||"").split(",").map(l=>mt(l)),o=t.map((l,f)=>({id:l,toKey:c[f]||""}));R(Se(o))},[s,r.search]),x.useEffect(()=>{try{if(!Array.isArray(p))return;if(p.length===0){(e||s)&&d("/setlist",{replace:!0});return}const t=p.map(l=>encodeURIComponent(l.id)).join(","),i=p.map(l=>encodeURIComponent(l.toKey||"")).join(","),c=s||"",o=new URLSearchParams(r.search||"").get("toKeys")||"";(t!==c||i!==o)&&d(`/setlist/${t}?toKeys=${i}`,{replace:!0})}catch{}},[p.map(t=>`${t.id}:${t.toKey}`).join("|"),s,r.search,e]),x.useEffect(()=>{try{const t=localStorage.getItem("setlist");if(!t||we().length>0)return;const i=JSON.parse(t);if(i?.name||(i?.list?.length||0)>0){const c=lt({name:i.name||"Imported Set",items:i.list||[]});y(we()),B(c.id),u(c.name),R(Se(c.items||[])),P(c.id)}}catch{}},[]),x.useEffect(()=>{function t(){try{const i=window.innerWidth;oe(i<=640),ee(i<=820),Ce(i<=900)}catch{}}return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),x.useEffect(()=>{new URLSearchParams(r.search||"").get("icp")==="1"&&$(!0)},[r.search]),x.useEffect(()=>{if(te.current)return;const t=r.state?.quickAction;t&&h.length&&(vt(t,h),te.current=!0,d(r.pathname+(r.search||""),{replace:!0,state:null}))},[r.state,h.map(t=>t.id).join("|")]);const ke=x.useMemo(()=>new Kt(h,{keys:["title","tags"],threshold:.4}),[h]);function Tt(t){return!S||(Array.isArray(t.tags)?t.tags.includes("ICP"):t.tags==="ICP")}const jt=x.useMemo(()=>(m?ke.search(m).map(i=>i.item):h.slice().sort((i,c)=>i.title.localeCompare(c.title))).filter(Tt),[m,ke,h,S]);function Ue(t){if(!t)return;const i=_e({id:t.id,toKey:t.originalKey||t.key||"C"});R(c=>[...c,i])}async function Xe(t){const i=Ht(t);if(i.error)return ue("Please check verse reference."),!1;const c=await Ct(i);if(!c.ok)return ue(c.message),!1;const o=_e({id:i.id,toKey:""});return o?(R(l=>[...l,o]),ve(""),ue(""),Re(!1),!0):!1}function Fe(t){R(i=>i.filter(c=>c.uid!==t))}function Ne(t,i){R(c=>{const o=c.findIndex(v=>v.uid===t);if(o<0)return c;const l=o+(i==="up"?-1:1);if(l<0||l>=c.length)return c;const f=c.slice(),[w]=f.splice(o,1);return f.splice(l,0,w),f})}function We(t,i){R(c=>{if(i<0||i>=c.length)return c;const o=c.findIndex(w=>w.uid===t);if(o<0||o===i)return c;const l=c.slice(),[f]=l.splice(o,1);return l.splice(i,0,f),l})}function vt(t,i){if(!t)return;function c(T){!T||!T.length||R(Se(T.map(M=>({id:M.id,toKey:M.toKey}))))}function o(T){return T?{id:T.id,toKey:T.originalKey||T.key||"C"}:null}function l(T,M){return T.filter(L=>L&&!M.has(L.id))}function f(T,M){const L=l(T,M),X=L.length?ot(L):null;return X&&M.add(X.id),X}function w(){const T=Pe(i,"FAST"),M=[],L=new Set;if((T.length>=4?pe(T,4):T.slice()).forEach(E=>{E&&L.add(E.id),M.push(E)}),M.length<4){const E=pe(l(i,L),Math.min(4-M.length,Math.max(0,i.length-M.length)));M.push(...E)}return M.filter(Boolean).map(o).filter(Boolean).slice(0,4)}function v(){const T=new Set,M=Pe(i,"SLOW"),L=Lt=>M.filter(Rt=>(Rt?.originalKey||"").toUpperCase()===Lt.toUpperCase()),X=Pe(i,"FAST"),E=f(L("G"),T)||f(M,T)||f(i,T),F=f(X,T)||f(i,T),H=f(L("A"),T)||f(M,T)||f(i,T);return[E,F,H].filter(Boolean).map(o).filter(Boolean)}function _(){const M=ot(["CROSS","COMMITMENT","MISSION","MISSIONS","PRAISE","HYMN"]),L=Pe(i,M),X=new Set,E=[];L.length>=4?E.push(...pe(L,4)):L.length>=2?E.push(...pe(L,Math.min(4,L.length))):L.length&&E.push(...L),E.forEach(H=>H&&X.add(H.id));const F=Math.max(0,2-E.length);if(F>0){const H=pe(l(i,X),Math.min(F,i.length-E.length));E.push(...H)}if(E.length<4){const H=pe(l(i,X),Math.min(4-E.length,i.length-E.length));E.push(...H)}return E.filter(Boolean).map(o).filter(Boolean).slice(0,4)}let Q=[];t==="celebrationSet"?Q=w():t==="threeSongFlow"?Q=v():t==="randomThemeSet"&&(Q=_()),Q.length&&c(Q)}function Nt(t,i){R(c=>c.map(o=>o.uid===t?{...o,toKey:i}:o))}function Ve(t){y(we()),P(t||"")}function ze(){B(null),u("New Setlist"),R([]),P("")}function It(){const t=a?.trim()||"New Setlist",i=window.prompt("Save set as:",t);if(i===null)return;const c=String(i).trim()||"New Setlist";let o=Y;if(!o){const w=(we()||[]).find(v=>(v.name||"")===c);w&&(o=w.id)}const l=p.map(({id:w,toKey:v})=>({id:w,toKey:v})),f=lt({id:o,name:c,items:l});u(f.name),B(f.id),Ve(f.id)}function Pt(){const t=O||b||"";if(!t){q(!1);return}const i=rn(t);i&&(B(i.id),u(i.name||"New Setlist"),R(Se(i.items||[])),P(i.id)),q(!1)}function Et(){const t=G[0]?.id||"";Ae(b||t),q(!0)}function Mt(){Y&&window.confirm(`Delete set "${a}"? This cannot be undone.`)&&(an(Y),ze(),Ve(""))}async function Ye(){z(!0);try{const{downloadMultiSongPdf:t}=await pt(),i=[];for(const c of p){const o=h.find(l=>l.id===c.id);if(o)try{const l=be(`songs/${o.filename}`),f=await Jt(l),w=Zt(f),v=w.meta?.key||w.meta?.originalkey||o.originalKey||"C",_=Gt(v,c.toKey||v),Q=(String(v).match(/^([A-G][#b]?)/)||[,""])[1],T=!!(Q&&/b$/.test(Q)),M=(w.sections||[]).map(E=>({section:E.label,lines:(E.lines||[]).map(F=>F.instrumental?{instrumental:Qt(F.instrumental,_,T)}:F.comment?{plain:F.comment,chordPositions:[],comment:F.comment}:{plain:F.lyrics||"",chordPositions:(F.chords||[]).map(H=>({sym:en(H.sym,_,T),index:H.index}))})})),L=o.filename.replace(/\.chordpro$/i,""),X=tn({title:w.meta?.title||o.title||L,key:c.toKey||v,capo:w.meta?.capo,lyricsBlocks:M});i.push(X)}catch(l){console.error(l),ne(`Failed to process ${o.filename}`)}}i.length&&await t(i)}finally{z(!1)}}function Ie(){pt()}async function qe(){try{const t=p.map(l=>encodeURIComponent(l.id)).join(","),i=p.map(l=>encodeURIComponent(l.toKey||"")).join(","),o=`${(()=>{try{if(typeof window<"u"&&window.location)return`${window.location.origin||""}/`}catch{}return""})()}setlist/${t}?toKeys=${i}`;await navigator.clipboard.writeText(o);try{ne?.("Link copied!")}catch{}}catch{alert("Failed to copy link")}}x.useEffect(()=>{if(!Le)return;const t=String(ce||"").split(/\d/)[0].trim(),i=Ut(t);St(i||"")},[ce,Le]);async function Ct(t){if(!t?.book||!t?.segments?.length)return{ok:!1,message:"Please check verse reference."};async function i(o,l){const f=`${o}::${l}`,w=bt.current;if(w.has(f))return w.get(f);try{const v=await fetch(be(`esv/${encodeURIComponent(o)}/${l}.json`));if(!v.ok)throw new Error("Missing chapter");const _=await v.json();return w.set(f,_),_}catch{return w.set(f,null),null}}let c=!1;for(const o of t.segments){const l=await i(t.book,o.chapter);if(!l?.verses)return{ok:!1,message:"No verse found."};const f=l.verses||{},w=Object.keys(f);if(!o.ranges){w.length&&(c=!0);continue}for(const v of o.ranges){const _=v.start,Q=v.end??_;if(!f[String(_)]||!f[String(Q)])return{ok:!1,message:"Please check verse reference."};c=!0}}return c?{ok:!0}:{ok:!1,message:"No verse found."}}function At(){if(!xe)return;const t=String(ce||"").search(/\d/);if(t===-1){ve(`${xe} `);return}const i=String(ce||"").slice(t).trim();ve(`${xe} ${i}`)}async function He(){if(A)return;k(`Bundling 0/${p.length}…`);const t=(await Oe(async()=>{const{default:o}=await import("./jszip.min-B0I7h7eF.js").then(l=>l.j);return{default:o}},__vite__mapDeps([0,1,2]))).default,i=new t;let c=0;for(let o=0;o<p.length;o++){const l=p[o],f=h.find(v=>v.id===l.id);if(!f){k(`Bundling ${o+1}/${p.length}…`);continue}k(`Bundling ${o+1}/${p.length}…`);const w=f.filename.replace(/\.chordpro$/i,"");if(K[w])try{const v=await fetch(be(`pptx/${w}.pptx`));if(!v.ok)continue;const _=await v.blob();c++,i.file(`${String(c).padStart(2,"0")}-${w}.pptx`,_)}catch{}}if(c>0){const o=await i.generateAsync({type:"blob"}),l=new Date().toISOString().slice(0,10).replace(/-/g,""),f=document.createElement("a");f.href=URL.createObjectURL(o),f.download=`setlist-pptx-${l}.zip`,f.click(),URL.revokeObjectURL(f.href)}else try{ne&&ne("No PPTX files found for selected songs")||alert("No PPTX files found for selected songs")}catch{}k("")}async function Je(){if(!(C||A)){D("Combining…");try{const t=[],i=[];for(const c of p){const o=h.find(f=>f.id===c.id);if(!o)continue;const l=o.filename.replace(/\.chordpro$/i,"");if(!K[l]){i.push(o.title||l);continue}t.push(o)}if(!t.length){try{ne&&ne("No PPTX files found for selected songs")||alert("No PPTX files found for selected songs")}catch{}return}if(i.length){const c=i.length===1?`${i[0]} PPT file unavailable`:`${i.length} songs missing PPT files`;try{ne?.(c)}catch{}}await En({name:a||"Setlist",songs:t},{})}catch(t){console.error(t);try{ne&&ne("Failed to combine PPTX files")||alert("Failed to combine PPTX files")}catch{}}finally{D("")}}}return n.jsxs(nn,{className:"is-setlist",children:[ye?n.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.45)",zIndex:90},role:"dialog","aria-modal":"true",children:n.jsxs("div",{style:{background:"var(--card)",color:"var(--text)",border:"1px solid var(--line)",borderRadius:10,padding:16,width:"min(560px, 92vw)"},children:[n.jsx("h3",{style:{marginTop:0,marginBottom:8},children:"Load Set"}),G.length?n.jsxs("label",{style:{display:"block",margin:"8px 0"},children:["Select a saved set",n.jsx("select",{value:O,onChange:t=>Ae(t.target.value),style:{width:"100%"},children:G.map(t=>n.jsxs("option",{value:t.id,children:[t.name," · ",new Date(t.updatedAt).toLocaleString()]},t.id))})]}):n.jsx("div",{className:"meta",children:"No saved sets yet."}),n.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:12},children:[n.jsx(j,{onClick:()=>q(!1),children:"Cancel"}),n.jsx(j,{variant:"primary",onClick:Pt,disabled:!G.length,children:"Load"})]})]})}):null,Le?n.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.45)",zIndex:90},role:"dialog","aria-modal":"true",children:n.jsxs("div",{style:{background:"var(--card)",color:"var(--text)",border:"1px solid var(--line)",borderRadius:10,padding:16,width:"min(560px, 92vw)"},children:[n.jsx("h3",{style:{marginTop:0,marginBottom:8},children:"Add Verse"}),n.jsxs("label",{style:{display:"block",margin:"8px 0"},children:[n.jsx("span",{className:"gc-label",children:"Bible verse"}),n.jsx(Ze,{value:ce,onChange:t=>{ve(t.target.value),$e&&ue("")},placeholder:"John 3:16",onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),Xe(ce))},style:{width:"100%"}})]}),xe?n.jsxs("div",{className:"meta",style:{marginTop:4},children:["Suggestion: ",n.jsx(j,{size:"sm",variant:"secondary",onClick:At,type:"button",children:xe})]}):null,$e?n.jsx("div",{className:"meta",style:{color:"var(--gc-danger)",marginTop:6},children:$e}):null,n.jsx("div",{style:{marginTop:12},children:n.jsx(Xt,{label:"Translation",disabled:!0,children:n.jsx("option",{children:"ESV"})})}),n.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:12},children:[n.jsx(j,{onClick:()=>{Re(!1),ue("")},children:"Cancel"}),n.jsx(j,{variant:"primary",onClick:()=>Xe(ce),children:"Add Verse"})]})]})}):null,n.jsx(Ft,{busy:Z}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:4},children:[n.jsx("div",{}),n.jsx("h1",{style:{margin:0},children:"Setlist Builder"}),n.jsx("div",{})]}),ae?n.jsx(Ge,{className:"card",style:{marginTop:8,position:"static"},children:n.jsxs("div",{className:"setlist-actions--mobile",style:{width:"100%"},children:[n.jsx(j,{variant:"primary",onClick:Ye,onMouseEnter:Ie,onFocus:Ie,disabled:Z||p.length===0,title:"Export set as a single PDF",iconLeft:n.jsx(fe,{}),children:"PDF"}),n.jsx(j,{onClick:Je,disabled:p.length===0||!!C||!!A,title:p.length===0?"Add songs to combine PPTX files":"Combine PPTX files into a single presentation",iconLeft:n.jsx(fe,{}),children:A||"Export PPT"}),n.jsx(j,{onClick:He,disabled:p.length===0||!!C||!!A,title:p.length===0?"Add songs to export PPTX bundle":"Export PPTX bundle (ZIP) for selected songs",iconLeft:n.jsx(fe,{}),children:"PPT ZIP"}),n.jsx(j,{onClick:qe,title:"Copy shareable link",iconLeft:n.jsx(Qe,{}),disabled:p.length===0,children:"Share"}),n.jsx(j,{as:et,to:p.length?`/worship/${p.map(t=>encodeURIComponent(t.id)).join(",")}?toKeys=${p.map(t=>encodeURIComponent(t.toKey||"")).join(",")}`:"/worship",title:"Open Worship Mode",iconLeft:n.jsx(tt,{}),children:"Worship"})]})}):n.jsxs(Ge,{className:"card",style:{marginTop:8,position:"static"},children:[n.jsx("div",{style:{width:"100%",marginBottom:6},children:n.jsx("strong",{title:"Current set name",children:a||"New Setlist"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",width:"100%"},children:[n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[n.jsxs(j,{size:"sm",variant:"secondary",onClick:It,title:"Save set",iconLeft:n.jsx(Wt,{}),children:[" ",n.jsx("span",{className:"text-when-wide",children:"Save"})]}),n.jsxs(j,{size:"sm",variant:"secondary",onClick:Et,title:"Load saved set",iconLeft:n.jsx(Vt,{}),disabled:!G.length,children:[" ",n.jsx("span",{className:"text-when-wide",children:"Load"})]}),n.jsxs(j,{size:"sm",variant:"secondary",onClick:ze,title:"New set",iconLeft:n.jsx(De,{}),children:[" ",n.jsx("span",{className:"text-when-wide",children:"New"})]}),n.jsxs(j,{size:"sm",variant:"secondary",onClick:Mt,disabled:!Y,title:"Delete set",iconLeft:n.jsx(zt,{}),children:[" ",n.jsx("span",{className:"text-when-wide",children:"Delete"})]}),n.jsxs(j,{size:"sm",variant:"secondary",onClick:qe,title:"Copy shareable link",iconLeft:n.jsx(Qe,{}),disabled:p.length===0,children:[" ",n.jsx("span",{className:"text-when-wide",children:"Share Set"})]})]}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[n.jsx(j,{variant:"primary",size:"md",onClick:Ye,onMouseEnter:Ie,onFocus:Ie,disabled:Z||p.length===0,title:"Export set as a single PDF",iconLeft:n.jsx(fe,{}),children:Z?"Exporting…":n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-when-wide",children:"Export PDF"}),n.jsx("span",{className:"text-when-narrow",children:"PDF"})]})}),n.jsx(j,{variant:"primary",size:"md",onClick:Je,disabled:p.length===0||!!C||!!A,title:p.length===0?"Add songs to combine PPTX files":"Combine PPTX files into a single presentation",iconLeft:n.jsx(fe,{}),children:A||n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-when-wide",children:"Export PPT"}),n.jsx("span",{className:"text-when-narrow",children:"Export PPT"})]})}),n.jsx(j,{variant:"primary",size:"md",onClick:He,disabled:p.length===0||!!C||!!A,title:p.length===0?"Add songs to export PPTX bundle":"Export PPTX bundle (ZIP) for selected songs",iconLeft:n.jsx(fe,{}),children:C||n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-when-wide",children:"PPT ZIP"}),n.jsx("span",{className:"text-when-narrow",children:"PPT ZIP"})]})}),n.jsxs(j,{variant:"primary",size:"md",as:et,to:p.length?`/worship/${p.map(t=>encodeURIComponent(t.id)).join(",")}?toKeys=${p.map(t=>encodeURIComponent(t.toKey||"")).join(",")}`:"/worship",title:"Open Worship Mode",iconLeft:n.jsx(tt,{}),children:[" ",n.jsx("span",{className:"text-when-wide",children:"Worship Mode"}),n.jsx("span",{className:"text-when-narrow",children:"Worship"})]})]})]})]}),n.jsxs("div",{className:"BuilderPage",style:{marginTop:8},children:[n.jsx("div",{className:"BuilderLeft",children:n.jsx("section",{className:"setlist-section setlist-add","data-role":"add",children:n.jsxs("div",{className:"card setlist-pane",children:[n.jsxs("div",{className:["BuilderHeader","section-header",le?"no-sticky":""].filter(Boolean).join(" "),style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("strong",{style:{whiteSpace:"nowrap"},children:"Add songs"}),n.jsx(Ze,{value:m,onChange:t=>g(t.target.value),placeholder:"Search...",style:{flex:1,minWidth:0}}),n.jsxs("label",{className:"row",style:{gap:6,alignItems:"center"},children:[n.jsx("input",{type:"checkbox",checked:S,onChange:t=>$(t.target.checked)}),n.jsx("span",{className:"meta",title:"Limit results to songs tagged ICP",children:"ICP only"})]})]}),n.jsx("div",{className:["BuilderScroll","setlist-scroll","setlist-list",le?"no-pane-scroll":"pane-scroll","pane--addSongs"].join(" "),children:ke?n.jsx("div",{style:{display:"grid",gap:".5rem",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",marginTop:6},children:jt.map(t=>n.jsx(Be,{title:t.title,subtitle:`${t.originalKey||""}${t.tags?.length?` • ${t.tags.join(", ")}`:""}`,rightSlot:n.jsx(j,{"aria-label":"Add",title:"Add to set",variant:"primary",iconLeft:n.jsx(De,{}),iconOnly:!0,onClick:i=>{i.stopPropagation(),Ue(t)}}),onClick:()=>Ue(t)},t.id))}):n.jsx("div",{children:"Loading search…"})})]})})}),n.jsx("div",{className:"BuilderRight",style:{minHeight:0,display:"flex",flexDirection:"column"},children:n.jsxs("section",{className:"setlist-section setlist-current","data-role":"current",children:[n.jsxs("div",{className:"card setlist-pane",children:[n.jsx("div",{className:["BuilderHeader","section-header",le?"no-sticky":""].filter(Boolean).join(" "),children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsxs("strong",{children:["Current setlist (",p.length,")"]}),n.jsx(j,{size:"sm",variant:"secondary",onClick:()=>{Re(!0),ue("")},iconLeft:n.jsx(De,{}),children:"Add Verse"})]})}),n.jsx("div",{className:["BuilderScroll","setlist-scroll","setlist-list",le?"no-pane-scroll":"pane-scroll","pane--currentSet"].join(" "),style:{marginTop:6},children:p.map((t,i)=>{if(nt(t.id)){const f=st(t.id)?.refDisplay||t.id;return n.jsx(Be,{draggable:!0,onDragStart:w=>{w.dataTransfer.setData("text/plain",String(t.uid||t.id)),w.dataTransfer.effectAllowed="move"},onDragOver:w=>{w.preventDefault(),w.dataTransfer.dropEffect="move"},onDrop:w=>{w.preventDefault();const v=w.dataTransfer.getData("text/plain");We(v,i)},title:f,subtitle:"ESV",rightSlot:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[n.jsx(j,{onClick:()=>Ne(t.uid,"up"),title:"Move up",iconLeft:n.jsx(rt,{})}),n.jsx(j,{onClick:()=>Ne(t.uid,"down"),title:"Move down",iconLeft:n.jsx(it,{})}),n.jsx(j,{onClick:()=>Fe(t.uid),title:"Remove",iconLeft:n.jsx(at,{}),iconOnly:!0,style:{color:"#b91c1c"}})]})},t.uid||`${t.id}-${i}`)}const o=h.find(l=>l.id===t.id);return o?n.jsx(Be,{draggable:!0,onDragStart:l=>{l.dataTransfer.setData("text/plain",String(t.uid||t.id)),l.dataTransfer.effectAllowed="move"},onDragOver:l=>{l.preventDefault(),l.dataTransfer.dropEffect="move"},onDrop:l=>{l.preventDefault();const f=l.dataTransfer.getData("text/plain");We(f,i)},title:o.title,subtitle:`Original: ${o.originalKey||"—"}`,rightSlot:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[n.jsx(Yt,{variant:"ui",baseKey:o.originalKey||"C",valueKey:t.toKey||o.originalKey||"C",onChange:l=>Nt(t.uid,l)}),n.jsx(j,{onClick:()=>Ne(t.uid,"up"),title:"Move up",iconLeft:n.jsx(rt,{})}),n.jsx(j,{onClick:()=>Ne(t.uid,"down"),title:"Move down",iconLeft:n.jsx(it,{})}),n.jsx(j,{onClick:()=>Fe(t.uid),title:"Remove",iconLeft:n.jsx(at,{}),iconOnly:!0,style:{color:"#b91c1c"}})]})},t.uid||`${t.id}-${i}`):null})})]}),n.jsxs("div",{className:"print-only",style:{marginTop:16},children:[n.jsx("h2",{style:{fontSize:"20pt",margin:"0 0 8pt 0"},children:a}),n.jsx("ol",{style:{fontSize:"12pt",lineHeight:1.4,paddingLeft:"1.2em"},children:p.map((t,i)=>{if(nt(t.id)){const o=st(t.id);return n.jsx("li",{children:o?.refDisplay||t.id},t.uid||`${t.id}-${i}`)}const c=h.find(o=>o.id===t.id);return c?n.jsxs("li",{children:[c.title," — ",t.toKey||c.originalKey||"—"]},t.uid||`${t.id}-${i}`):null})})]})]})})]})]})}export{Ln as default};
