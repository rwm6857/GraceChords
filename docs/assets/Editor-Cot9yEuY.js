import{r as i,j as e,I as Z,B as k,c as V,L as le,H as re,S as ce,M as de,t as ue,C as he,A as ge,v as me,s as I,i as pe,p as ee,P as Y,T as oe,a as xe,b as fe,g as te,d as je,e as ye,f as be,h as Se,k as ve,K as M,l as we,m as Ce,n as ke,o as Ne,q as Te,u as se,w as Ee,x as Ie}from"./index-Dk7qes1v.js";import{R as $e}from"./AdminResources-DPl3LeY1.js";import"./markdown-DhTLSAy7.js";const Re="10401040",ne=`{title: }
{key: }
{authors: }
{country: }
{tags: }
{youtube: }
{mp3: }

`;function De(){const[l,c]=i.useState(()=>{try{return localStorage.getItem("editor:author")||""}catch{return""}}),[d,o]=i.useState(""),[m,y]=i.useState(!1),[x,f]=i.useState("");i.useEffect(()=>{try{localStorage.setItem("editor:author",l||"")}catch{}},[l]);function w(h){if(h.preventDefault(),f(""),!l.trim()){f("Author name is required.");return}d===Re?y(!0):f("Invalid password.")}return m?e.jsx(Me,{authorName:l.trim()}):e.jsxs("div",{className:"container",style:{maxWidth:520},children:[e.jsx("h1",{children:"GraceChords Editor"}),e.jsx("p",{children:"Enter your author name and password to continue."}),e.jsxs("form",{onSubmit:w,className:"card",style:{display:"grid",gap:10,padding:16},children:[e.jsxs("label",{children:["Author name",e.jsx(Z,{value:l,onChange:h=>c(h.target.value),placeholder:"Your name",required:!0})]}),e.jsxs("label",{children:["Password",e.jsx(Z,{type:"password",value:d,onChange:h=>o(h.target.value),placeholder:"Password",required:!0})]}),x?e.jsx("div",{className:"alert error Small",children:x}):null,e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:e.jsx(k,{variant:"primary",type:"submit",children:"Enter"})})]})]})}function Me({authorName:l}){const[c,d]=i.useState("songs"),[o,m]=i.useState(()=>{try{const a=sessionStorage.getItem("editor:staged");return a?JSON.parse(a):[]}catch{return[]}});i.useEffect(()=>{try{o.length?sessionStorage.setItem("editor:staged",JSON.stringify(o)):sessionStorage.removeItem("editor:staged")}catch{}},[o]);const[y,x]=i.useState(!1),[f,w]=i.useState(!1),[h,g]=i.useState("main"),[N,p]=i.useState(null),[,$]=i.useState(0),R=V&&typeof V=="function"?V()==="dark":!1;function P(a){a?.length&&m(v=>[...v,...a])}function _(a){a?.length&&m(v=>[...v,...a])}function F(a){m(v=>v.filter((W,S)=>S!==a))}function C(){m([])}async function G(){try{const a=await me();p(a),I?.(`Token OK: ${a.login}`)??alert(`Token OK: ${a.login}`)}catch(a){p(null),I?.(String(a.message||a))??alert(String(a.message||a))}}function D(){const a=prompt("Paste GitHub token (repo scope):","");a!==null&&localStorage.setItem("ghToken",a.trim())}function A(){localStorage.removeItem("ghToken"),p(null)}async function U(){if(!o.length){I?.("Stage at least one change first.")??alert("Stage at least one change first.");return}if(!l){I?.("Author name required to open a PR.")??alert("Author name required to open a PR.");return}try{const{default_branch:a}=await te({owner:"rwm6857",repo:"GraceChords"});g(a||"main"),x(!0)}catch(a){I?.(String(a.message||a))??alert(String(a.message||a))}}async function q({branchName:a,prTitle:v,prBody:W}){w(!0);try{const S="rwm6857",b="GraceChords",{sha:z}=await te({owner:S,repo:b});await je({owner:S,repo:b,fromSha:z,newBranch:a});for(const T of o){if(T.action==="delete-request")continue;const H=`${T.kind==="song"?"public/songs":"public/resources"}/${T.filename}`,O=await ye({owner:S,repo:b,path:H,ref:a}),Q=T.action==="add"?`add: ${T.filename}`:`update: ${T.filename}`;await be({owner:S,repo:b,branch:a,path:H,contentBase64:Se(T.content||""),message:Q,sha:O})}const K=await ve({owner:S,repo:b,head:a,base:h,title:v,body:W});try{sessionStorage.removeItem("editor:staged")}catch{}m([]),x(!1),window.open(K.html_url,"_blank","noopener")}catch(S){throw I?.(String(S.message||S))??alert(String(S.message||S)),S}finally{w(!1)}}return e.jsx("div",{className:"gc-editor-page",children:e.jsxs("div",{className:"container gc-editor",children:[e.jsx(Fe,{}),e.jsxs("header",{className:"gc-editor__header",children:[e.jsxs("div",{className:"gc-editor__title",children:[e.jsx("h1",{children:"GraceChords Editor"}),e.jsxs("span",{className:"gc-editor__author",children:["Author: ",l]})]}),e.jsxs("nav",{className:"gc-editor__tabs","aria-label":"Editor tabs",children:[e.jsx("button",{className:`gc-editor__tab ${c==="songs"?"is-active":""}`,onClick:()=>d("songs"),children:"ðŸŽµ Songs"}),e.jsx("button",{className:`gc-editor__tab ${c==="posts"?"is-active":""}`,onClick:()=>d("posts"),children:"ðŸ“„ Posts"})]}),e.jsxs("div",{className:"gc-editor__actions",children:[e.jsx(le,{to:"/",className:"gc-editor__iconbtn",title:"Back to home","aria-label":"Back to home",children:e.jsx(re,{size:18})}),e.jsx("button",{className:"gc-editor__iconbtn","aria-label":"Toggle theme",onClick:()=>{ue(),$(a=>a+1)},title:R?"Switch to light mode":"Switch to dark mode",children:R?e.jsx(ce,{size:18}):e.jsx(de,{size:18})})]})]}),e.jsxs("div",{className:"gc-editor-shell",children:[e.jsx("div",{className:"gc-editor-panel gc-editor__github",children:e.jsxs("div",{className:"Row Small",style:{alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("strong",{children:"GitHub:"}),e.jsxs("span",{children:["Token: ",N?`@${N.login}`:localStorage.getItem("ghToken")?"set":"not set"]}),e.jsx("button",{className:"btn",onClick:D,children:"Set token"}),e.jsx("button",{className:"btn",onClick:A,children:"Clear"}),e.jsx("button",{className:"btn",onClick:G,children:"Validate"})]})}),c==="songs"?e.jsx(Pe,{onStageSong:P}):e.jsx(_e,{onStagePost:_}),e.jsxs("section",{className:"gc-editor-panel gc-editor-panel--staged gc-staged-card",children:[e.jsxs("div",{className:"Row",style:{alignItems:"center",gap:8},children:[e.jsxs("h3",{style:{margin:0},children:["Staged changes ",e.jsxs("span",{className:"Small",children:["(",o.length,")"]})]}),e.jsx("div",{className:"spacer"}),e.jsx(k,{onClick:C,disabled:!o.length,children:"Clear all"}),e.jsxs(k,{variant:"primary",onClick:U,disabled:!o.length,children:[e.jsx(he,{})," Open PR"]})]}),e.jsx("div",{style:{width:"100%",marginTop:8,overflow:"auto"},children:e.jsxs("table",{className:"Table Small",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kind"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Filename"}),e.jsx("th",{children:"Details"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[o.map((a,v)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.kind}),e.jsx("td",{children:a.action}),e.jsx("td",{children:a.title}),e.jsx("td",{children:e.jsx("code",{children:a.filename})}),e.jsx("td",{children:a.changeSummary||a.deleteReason||""}),e.jsx("td",{children:e.jsx("button",{className:"btn small",onClick:()=>F(v),children:"Remove"})})]},`${a.filename}-${v}`)),!o.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"Small",style:{textAlign:"center",padding:12},children:"Nothing staged yet."})})]})]})})]})]}),o.length>0&&e.jsxs("button",{className:"gc-staged-floating",onClick:U,children:["Staged: ",o.length," â€“ Review / Open PR"]}),e.jsx(ge,{open:y,onClose:()=>x(!1),defaultBranch:h,staged:o,authorName:l,onCreate:q,busy:f})]})})}function Pe({onStageSong:l}){const[c,d]=i.useState(ne),[o,m]=i.useState({});i.useEffect(()=>{m(ae(c))},[c]);const y=i.useRef(null),[x,f]=i.useState(()=>{try{return localStorage.getItem("editor:showPreview")!=="0"}catch{return!0}});i.useEffect(()=>{try{localStorage.setItem("editor:showPreview",x?"1":"0")}catch{}},[x]);const w=i.useMemo(()=>{const t=pe?.items||[],s=new Set,r=[];for(const n of t)s.has(n.id)||(s.add(n.id),r.push(n));return r},[]),[h,g]=i.useState(""),[N,p]=i.useState(null),[$,R]=i.useState(""),[P,_]=i.useState(""),[F,C]=i.useState(!1),[G,D]=i.useState(""),A=i.useMemo(()=>{const t=P.trim().toLowerCase();return t?w.filter(s=>{const r=String(s.title||"").toLowerCase(),n=(s.tags||[]).map(j=>String(j).toLowerCase()).join(" "),u=(s.authors||[]).map(j=>String(j).toLowerCase()).join(" ");return r.includes(t)||n.includes(t)||u.includes(t)}).slice(0,12):[]},[w,P]);async function U(t){if(t)try{const r=`${"./".replace(/\/+$/,"")+"/"}songs/${t.filename}`,n=await Ce(r);if(n){d(n);const u=ae(n),j=K(n,u,t.filename);g(t.filename),p(u),R(j?.content||""),_("")}}catch(s){console.error(s),alert(`Failed to load ${t.filename}`)}}function q(){g(""),p(null),R(""),d(ne)}function a(t){const s=y.current;if(!s){d(u=>(u||"")+t);return}const r=s.selectionStart??0,n=s.selectionEnd??r;d(u=>{const j=u.slice(0,r),E=u.slice(n);return j+t+E}),setTimeout(()=>{try{s.focus();const u=r+t.length;s.setSelectionRange(u,u)}catch{}},0)}function v(t){const s={Verse:{start:`{sov Verse}
`,end:`{eov}
`},Chorus:{start:`{soc Chorus}
`,end:`{eoc}
`},Bridge:{start:`{sob Bridge}
`,end:`{eob}
`}}[t]||{start:`{start_of_${t.toLowerCase()}}:
`,end:`{end_of_${t.toLowerCase()}}
`};a(`${s.start}${s.end}`)}function W(t){const s=[0,2,4,5,7,9],r=new Set([1,2,5]),n=String(t||"").toUpperCase(),u=M.indexOf(n),j=u>=0?u:M.indexOf("G"),E=[];for(let L=0;L<s.length;L++){const ie=(j+s[L])%M.length,X=M[ie];E.push(r.has(L)?`${X}m`:X)}return E}function S(t){const s=String(t).trim();if(!s)return"G";const r=/^([A-Ga-g][#b]?)(m|min)?$/i.exec(s);if(!r)return"G";const n=we(r[1]),u=M.indexOf(n);if(u<0)return"G";const E=!!r[2]?(u+3)%M.length:u;return M[E]}const b=i.useMemo(()=>{try{const t=ee(c||""),s=(t.sections||[]).map(r=>({section:r.label,lines:(r.lines||[]).map(n=>({text:n.instrumental?"":n.comment||n.lyrics||"",chords:n.instrumental?[]:n.chords||[],comment:!!n.comment,instrumental:n.instrumental||null}))}));return{meta:t.meta,blocks:s}}catch{return{meta:{},blocks:[]}}},[c]),z=i.useMemo(()=>W(S(o.key||"G")),[o.key]);i.useEffect(()=>{function t(s){if(F||!s.altKey)return;const r=s.key;if(!/^([1-6])$/.test(r))return;const n=parseInt(r,10)-1,u=z[n];u&&(s.preventDefault(),a(`[${u}]`))}return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[z,F]);function K(t=c,s=o,r=h){try{const{text:n,docTitle:u,docKey:j}=Ne(t,{country:s.country||"",tags:s.tags||"",youtube:s.youtube||"",mp3:s.mp3||""}),E=r||Te(u),L=se(n);return{filename:E,title:u||s.title||"Untitled",content:L,key:j||s.key||""}}catch{}try{const n=ee(t);n.meta.title=s.title||n.meta.title||"",n.meta.key=s.key||n.meta.key||"",n.meta.meta={...n.meta.meta||{},authors:s.authors||n.meta.meta?.authors||"",country:s.country||n.meta.meta?.country||"",tags:s.tags||n.meta.meta?.tags||"",youtube:s.youtube||n.meta.meta?.youtube||"",mp3:s.mp3||n.meta.meta?.mp3||""};let u=Ee(n,{useDirectives:!0});u=se(u);const j=Ie(s.id||n.meta.title||"untitled");return{filename:r||`${j}.chordpro`,title:n.meta.title||"Untitled",content:u,key:n.meta.key||""}}catch(n){return console.error(n),null}}const T=(c||"").replace(/\s+/g,"").replace(/\{[^}]*\}/g,""),J=!!((o.title||"").trim()||T),H=!!h;function O(){const t=K();if(!t)return;if(!H){l([{kind:"song",action:"add",title:t.title,filename:t.filename,content:t.content}]),q();return}const s=[];(o.title||"").trim()!==(N?.title||"").trim()&&s.push("Title"),["authors","tags","key","country","youtube"].some(j=>(o[j]||"").trim()!==(N?.[j]||"").trim())&&s.push("Metadata"),(t.content||"")!==($||"")&&s.push("Content");const u=s.length?s.join(" + "):"Minor edit";l([{kind:"song",action:"edit",title:t.title,filename:h,content:t.content,changeSummary:u}]),q()}function Q(t){h&&(l([{kind:"song",action:"delete-request",title:o.title||"Untitled",filename:h,deleteReason:t}]),D(""),C(!1),q())}return e.jsxs("div",{className:"gc-song-editor",children:[e.jsx("section",{className:"gc-editor-panel gc-editor-panel--selector",children:e.jsxs("div",{className:"gc-song-selector",children:[e.jsx(k,{onClick:q,iconLeft:e.jsx(Y,{}),children:"New Song"}),e.jsxs("div",{className:"gc-song-selector__search",children:[e.jsx("input",{type:"search",placeholder:"Search existing songsâ€¦",value:P,onChange:t=>_(t.target.value),onKeyDown:t=>{t.key==="Enter"&&A.length&&(t.preventDefault(),U(A[0]))}}),A.length>0&&e.jsx("ul",{className:"gc-song-selector__results",children:A.map(t=>e.jsx("li",{onMouseDown:()=>U(t),children:t.title},t.id))})]}),h?e.jsxs("span",{className:"badge",style:{background:"#fde68a",color:"#92400e"},children:["Editing ",h]}):e.jsx("span",{className:"badge",style:{background:"#d1fae5",color:"#065f46"},children:"New song"})]})}),e.jsxs("section",{className:"gc-editor-panel gc-editor-panel--meta",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginTop:12},children:[e.jsxs("label",{children:["Title",e.jsx("input",{value:o.title||"",onChange:t=>d(s=>B(s,"title",t.target.value))})]}),e.jsxs("label",{children:["Original Key",e.jsx("input",{value:o.key||"",onChange:t=>d(s=>B(s,"key",t.target.value)),placeholder:"e.g., C, Am, Dm, F#m"})]}),e.jsxs("label",{children:["Authors",e.jsx("input",{value:o.authors||"",onChange:t=>d(s=>B(s,"authors",t.target.value))})]}),e.jsxs("label",{children:["Country",e.jsx("input",{value:o.country||"",onChange:t=>d(s=>B(s,"country",t.target.value))})]}),e.jsxs("label",{children:["Tags",e.jsx("input",{value:o.tags||"",onChange:t=>d(s=>B(s,"tags",t.target.value)),placeholder:"Fast, Slow, Hymn, Holiday"})]}),e.jsxs("label",{children:["YouTube (ID or URL)",e.jsx("input",{value:o.youtube||"",onChange:t=>d(s=>B(s,"youtube",t.target.value)),placeholder:"e.g. dQw4w9WgXcQ or https://youtu.be/..."})]})]}),e.jsxs("section",{className:"gc-editor-panel gc-editor-panel--body",style:{marginTop:12},children:[e.jsxs("div",{className:"gc-editor-toolbar",children:[e.jsxs("div",{className:"gc-quick-row",children:[e.jsx("strong",{children:"Quick chords"}),e.jsxs("span",{className:"Small",children:["(Key: ",o.key||"G",")"]}),z.map((t,s)=>e.jsx("button",{className:"gc-btn gc-btn--sm",onClick:()=>a(`[${t}]`),title:`Insert [${t}] (Alt+${s+1})`,children:t},t))]}),e.jsxs("div",{className:"gc-quick-sections",children:[e.jsx("span",{className:"Small",children:"Quick sections:"}),e.jsx("button",{className:"gc-btn gc-btn--sm",onClick:()=>v("Verse"),children:"Verse"}),e.jsx("button",{className:"gc-btn gc-btn--sm",onClick:()=>v("Chorus"),children:"Chorus"}),e.jsx("button",{className:"gc-btn gc-btn--sm",onClick:()=>v("Bridge"),children:"Bridge"})]}),e.jsxs("label",{className:"gc-preview-toggle",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:t=>f(t.target.checked)})," Preview"]})]}),e.jsxs("div",{className:`gc-editor-split ${x?"":"is-single"}`,children:[e.jsx("div",{className:"gc-editor-pane gc-editor-pane--input",children:e.jsx("textarea",{ref:y,value:c,onChange:t=>d(t.target.value),style:{width:"100%",minHeight:"60vh",height:"60vh",fontFamily:'"Roboto Mono", ui-monospace, Menlo, Consolas, monospace',fontSize:x?void 0:"calc(1rem + 2pt)"}})}),x&&e.jsxs("div",{className:"gc-editor-pane gc-editor-pane--preview",children:[e.jsx("strong",{children:"Preview"}),e.jsx("div",{className:"Small",style:{marginTop:6,fontFamily:'"Roboto Mono", ui-monospace, Menlo, Consolas, monospace'},children:(()=>{const t={title:b?.meta?.title,key:b?.meta?.key||b?.meta?.originalkey,capo:b?.meta?.capo,authors:b?.meta?.meta?.authors,country:b?.meta?.meta?.country,tags:b?.meta?.meta?.tags,youtube:b?.meta?.meta?.youtube,mp3:b?.meta?.meta?.mp3};return Object.entries(t).filter(([,s])=>s!=null&&String(s).trim()!=="").map(([s,r])=>e.jsxs("div",{children:[e.jsx("strong",{children:s}),": ",String(r)]},s))})()}),e.jsx("div",{style:{marginTop:8},children:(b.blocks||[]).map((t,s)=>e.jsxs("div",{children:[e.jsx("div",{className:"section",children:t.section||""}),(t.lines||[]).map((r,n)=>r.instrumental?e.jsx(Ae,{spec:r.instrumental},`${s}-${n}`):e.jsx(qe,{plain:r.text,chords:r.chords||[],comment:r.comment},`${s}-${n}`))]},s))})]})]}),e.jsxs("div",{className:"gc-stage-actions",children:[e.jsx(k,{variant:"primary",onClick:O,disabled:!J,children:"Add Changes"}),H&&e.jsx(k,{onClick:()=>C(!0),iconLeft:e.jsx(oe,{}),children:"Request Deletion"}),e.jsx("span",{className:"Small",style:{marginLeft:"auto"},children:"Files save as .chordpro"})]})]}),F&&e.jsx("div",{className:"modal",children:e.jsxs("div",{className:"modal-body",children:[e.jsx("h3",{children:"Request Deletion"}),e.jsxs("label",{children:["Why should this song be removed?",e.jsx("textarea",{rows:3,value:G,onChange:t=>D(t.target.value),placeholder:"Reason for deletion"})]}),e.jsxs("div",{className:"Row",style:{justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>{C(!1),D("")},children:"Cancel"}),e.jsx("button",{className:"btn primary",onClick:()=>Q(G),disabled:!G.trim(),children:"Submit request"})]})]})})]})}function _e({onStagePost:l}){const[c,d]=i.useState(null),[o,m]=i.useState(""),[y,x]=i.useState("");function f(g){if(g){if(g.isExisting){I?.("Use Stage Edit for existing posts.")??alert("Use Stage Edit for existing posts.");return}l([{kind:"post",action:"add",title:g.meta?.title||"Untitled",filename:g.filename,content:g.content}])}}function w(g){if(!g?.isExisting){I?.("Load an existing post to stage an edit.")??alert("Load an existing post to stage an edit.");return}l([{kind:"post",action:"edit",title:g.meta?.title||"Untitled",filename:g.filename,content:g.content,changeSummary:o||""}])}function h(g){if(!g?.isExisting){I?.("Load an existing post to request deletion.")??alert("Load an existing post to request deletion.");return}l([{kind:"post",action:"delete-request",title:g.meta?.title||"Untitled",filename:g.filename,deleteReason:y||""}])}return e.jsx($e,{heading:"Posts",showGhTools:!1,wrapInContainer:!1,panelize:!0,onDraftChange:d,actions:({draft:g,newPost:N})=>{const p=g||c;return e.jsxs(xe,{style:{position:"sticky",bottom:0,marginTop:12,display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsxs(k,{onClick:N,children:[e.jsx(Y,{})," New"]}),e.jsxs(k,{onClick:()=>f(p),disabled:!p,children:[e.jsx(Y,{})," Stage Add"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[e.jsxs("label",{className:"Small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:"Filename"}),e.jsx("input",{readOnly:!0,value:p?.filename||"",style:{width:240},placeholder:"slug.md"})]}),p?.isExisting?e.jsx("span",{className:"badge",style:{background:"#fde68a",color:"#92400e"},title:"Editing existing file",children:"Editing"}):e.jsx("span",{className:"badge",style:{background:"#d1fae5",color:"#065f46"},title:"New file will be created",children:"New"})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{className:"Small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:"What changed?"}),e.jsx("input",{value:o,onChange:$=>m($.target.value),placeholder:"Content, tagsâ€¦",disabled:!p?.isExisting})]}),e.jsxs(k,{className:"gc-btn gc-btn--primary",onClick:()=>w(p),disabled:!p?.isExisting,children:[e.jsx(fe,{})," Stage Edit"]}),e.jsxs("label",{className:"Small",style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:"Removal reason"}),e.jsx("input",{value:y,onChange:$=>x($.target.value),placeholder:"Why remove this post?",disabled:!p?.isExisting})]}),e.jsxs(k,{className:"gc-btn gc-btn--primary",onClick:()=>h(p),disabled:!p?.isExisting,children:[e.jsx(oe,{})," Stage Deletion"]})]})]})}})}function Fe(){const[l,c]=i.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"gc-editor-help-tab",onClick:()=>c(d=>!d),"aria-expanded":l,"aria-label":"Open editor help",children:"Editor Help"}),l&&e.jsxs("div",{className:"gc-editor-help-drawer",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[e.jsx("strong",{children:"Editor Help"}),e.jsx("button",{className:"btn small",onClick:()=>c(!1),"aria-label":"Close help",children:"âœ•"})]}),e.jsxs("div",{className:"gc-help__content Small",style:{marginTop:8},children:[e.jsx("h3",{children:"Editor basics"}),e.jsx("p",{children:"Fill metadata (title, key, authors, country, tags, YouTube). Use quick chords and quick sections to speed up typing."}),e.jsx("p",{children:"New Song + search lets you start fresh or load an existing song to edit."}),e.jsx("h3",{children:"ChordPro tips"}),e.jsxs("p",{children:["Place chords in square brackets like ",e.jsx("code",{children:"[G]"}),". Section headers use short codes such as ",e.jsx("code",{children:"{sov Verse}"})," â€¦ ",e.jsx("code",{children:"{eov}"}),"."]}),e.jsx("pre",{className:"Small",style:{whiteSpace:"pre-wrap"},children:`{title: Example}
{key: G}
{sov Verse}
[G]Amazing [C]grace
{eov}`}),e.jsx("h3",{children:"Staging & PRs"}),e.jsx("p",{children:"â€œAdd Changesâ€ stages the current song (new or edited) for the PR. Deletion requests log a reason without deleting files."}),e.jsx("p",{children:"Use the staged table or floating pill to review and open the PR; a maintainer will review and merge."})]})]})]})}function Ae({spec:l}){const c=ke(l||{},{split:!1});return c.length?e.jsx("div",{style:{marginBottom:10},children:c.map((d,o)=>e.jsx("div",{style:{whiteSpace:"pre",fontFamily:"'Fira Mono', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace",fontWeight:700,fontSize:"inherit",lineHeight:1.35},children:d},o))}):null}function qe({plain:l,chords:c,comment:d}){if(d)return e.jsx("div",{className:"comment",children:l});const o=i.useRef(null),m=i.useRef(null),[y,x]=i.useState({offsets:[],padTop:0,chordTop:0});return i.useEffect(()=>{if(!o.current)return;if(!m.current){const C=document.createElement("canvas");C.width=1,C.height=1,m.current=C}const f=m.current.getContext("2d"),w=o.current.querySelector(".lyrics"),h=window.getComputedStyle(w);f.font=`${h.fontStyle} ${h.fontWeight} ${h.fontSize} ${h.fontFamily}`;const g=(c||[]).map(C=>({left:f.measureText(l.slice(0,C.index)).width,sym:C.sym})),N="'Fira Mono', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace",p=h.fontSize;f.font=`${h.fontStyle} 700 ${p} ${N}`;const R=f.measureText("Mg").actualBoundingBoxAscent||parseFloat(h.fontSize)*.8,_=Math.ceil(R+4);x({offsets:g,padTop:_,chordTop:0})},[l,c]),e.jsxs("div",{ref:o,style:{position:"relative",marginBottom:10,paddingTop:y.padTop},children:[y.offsets.length>0&&e.jsx("div",{"aria-hidden":!0,className:"chord-layer",style:{position:"absolute",left:0,right:0,top:y.chordTop},children:y.offsets.map((f,w)=>e.jsx("span",{style:{position:"absolute",left:`${f.left}px`,fontFamily:"'Fira Mono', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace",fontWeight:700},children:f.sym},w))}),e.jsx("div",{className:"lyrics",children:l})]})}function B(l,c,d){const o=new RegExp(`\\{\\s*${c}\\s*:[^}]*\\}`,"i");return o.test(l)?l.replace(o,`{${c}: ${d}}`):/\{\s*title\s*:[^}]*\}/i.test(l)?l.replace(/\{\s*title\s*:[^}]*\}\s*/,m=>m+`
{${c}: ${d}}
`):`{${c}: ${d}}
`+l}function ae(l){const c={},d=/^\{\s*([^:}]+)\s*:\s*([^}]*)\s*\}\s*$/gm;let o;for(;o=d.exec(l);){const m=o[1].trim().toLowerCase(),y=o[2];c[m]=y}return c}export{De as default};
