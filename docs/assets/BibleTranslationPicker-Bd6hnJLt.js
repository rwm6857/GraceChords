import{r as p,j as u}from"./index-DyMCvJez.js";function _(e,o){const n=new Map;for(const t of e||[]){const a=k(t.language),l=n.get(a);if(l){l.translations.push(t);continue}n.set(a,{languageCode:a,languageLabel:w(a),translations:[t]})}const s=Array.from(n.values());for(const t of s)t.translations.sort((a,l)=>g(a).localeCompare(g(l),void 0,{sensitivity:"base"}));return s.sort((t,a)=>t.languageLabel.localeCompare(a.languageLabel,void 0,{sensitivity:"base"})),s}function g(e){const o=String(e?.label||e?.id||"").trim(),n=String(e?.name||"").trim();return n?!o||y(n)===y(o)||n.includes(`(${o})`)?n:`${n} (${o})`:o||String(e?.id||"").toUpperCase()}function k(e){return String(e||"").trim().toLowerCase().replace(/_/g,"-")||"und"}function w(e,o){const n=x(),s=h(e,n);return s||(e==="und"?"Unknown":e.split("-").map(t=>t.toUpperCase()).join("-"))}function x(){try{if(typeof navigator<"u"&&navigator.language)return navigator.language}catch{}return"en"}function h(e,o){try{if(typeof Intl>"u"||typeof Intl.DisplayNames!="function")return null;const n=new Intl.DisplayNames([o],{type:"language"}),s=n.of(e);if(s&&s.toLowerCase()!==e.toLowerCase())return s;const t=e.split("-")[0];if(!t||t===e)return null;const a=n.of(t);return a&&a.toLowerCase()!==t.toLowerCase()?a:null}catch{return null}}function y(e){return String(e||"").toLowerCase().replace(/[^a-z0-9]/g,"")}function j({id:e,value:o,groups:n,onChange:s,ariaLabel:t="Choose Bible translation",labelPrefix:a="",fullWidth:l=!1}){const[d,f]=p.useState(!1),b=p.useRef(null),L=p.useMemo(()=>(n||[]).flatMap(r=>(r.translations||[]).map(i=>({id:i.id,label:i.label||i.id.toUpperCase(),displayLabel:g(i),languageCode:r.languageCode}))),[n]),m=L.find(r=>r.id===o)||L[0]||null,C=a?`${a}: ${m?.label||""}`.trim():String(m?.label||"").trim();return p.useEffect(()=>{if(!d)return;function r(c){const v=c.target;v&&(b.current?.contains(v)||f(!1))}function i(c){c.key==="Escape"&&f(!1)}return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r,{passive:!0}),document.addEventListener("keydown",i),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r),document.removeEventListener("keydown",i)}},[d]),u.jsxs("div",{ref:b,className:`gc-translation-picker ${l?"is-full":""}`.trim(),children:[u.jsx("button",{id:e,type:"button",className:"gc-translation-picker__button","aria-label":t,"aria-haspopup":"listbox","aria-expanded":d?"true":"false",onClick:()=>f(r=>!r),children:C}),d?u.jsx("div",{className:"gc-translation-picker__menu",role:"listbox","aria-label":t,children:n.map(r=>u.jsxs("div",{className:"gc-translation-picker__group",children:[u.jsx("div",{className:"gc-translation-picker__group-label",role:"presentation",children:r.languageLabel}),r.translations.map(i=>{const c=i.id===m?.id;return u.jsx("button",{type:"button",role:"option","aria-selected":c?"true":"false",className:`gc-translation-picker__option ${c?"is-selected":""}`.trim(),onClick:()=>{s(i.id),f(!1)},children:g(i)},i.id)})]},r.languageCode))}):null]})}export{j as B,_ as b};
